---
layout: none
permalink: .htaccess
---
# Disable php
RemoveHandler .php .phtml .php3
RemoveType .php .phtml .php3

# Disable directory indexes
Options -Indexes

# Index
DirectoryIndex index.html index.htm

# 404 error
ErrorDocument 404 /404.html

RewriteEngine On

RewriteRule ^.well-known/(.*)$ - [L]

# HSTS preload for 6 months
Header always set Strict-Transport-Security "max-age=15768000; includeSubDomains; preload"

# Redirect all HTTP to HTTPS
# (Must come before redirecting www to non-www as required by hstspreload.appspot.com)
RewriteCond %{HTTPS} off
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Redirect www to non-www
RewriteCond %{HTTP_HOST} ^www\.dchest\.com [NC]
RewriteRule ^(.*)$ https://dchest.com/$1 [L,R=301]

# Redirect dchest.org to dchest.com
RewriteCond %{HTTP_HOST} ^(www\.)*dchest\.org [NC]
RewriteRule ^(.*)$ https://dchest.com/$1 [L,R=301]

# Security headers
Header always set X-Frame-Options "SAMEORIGIN"
Header always set X-XSS-Protection "1; mode=block"
Header always set X-Content-Type-Options "nosniff"

# Cool URIs Don't Change.
RedirectPermanent /nextcloud/ /2016/11/18/synchronizing-android-and-macos-with-nextcloud/
RedirectPermanent /nearlyfreespeech/ /2016/10/23/nearlyfreespeech/
RedirectPermanent /aqdataextensions/ /2011/07/12/aqdataextensions/

RedirectPermanent /feed/ /atom.xml

# Optimizations

# Add MIME types for fonts
AddType application/x-font-ttf           .ttf
AddType application/font-woff            .woff
AddType application/font-woff2           .woff2

# Enable gzip compression
SetOutputFilter DEFLATE
AddOutputFilterByType DEFLATE text/html text/plain text/xml text/javascript text/css application/x-javascript

# Set far future expiration
ExpiresActive On
ExpiresByType text/javascript "access plus 1 years"
ExpiresByType application/x-javascript "access plus 1 years"
ExpiresByType text/css "access plus 1 years"
ExpiresByType image/png "access plus 1 years"
ExpiresByType image/jpeg "access plus 1 years"
ExpiresByType image/gif "access plus 1 years"
ExpiresByType image/vnd.microsoft.icon "access plus 1 years"
ExpiresByType application/x-font-ttf "access plus 1 years"
ExpiresByType application/font-woff "access plus 1 years"
ExpiresByType application/font-woff2 "access plus 1 years"

# Cache-control for html
#<FilesMatch "\.(xml|txt|html|htm)$">
# 2 HOURS
#Header set Cache-Control "max-age=7200"
#</FilesMatch>
